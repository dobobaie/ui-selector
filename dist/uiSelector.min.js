"function"==typeof require&&require("hammerjs");var uiSelector=function(e){return(new function(){this.init=function(){return"string"==typeof e?m.elParent=document.querySelector(e):"object"==typeof e&&void 0!=e.el?"string"==typeof e.el?m.elParent=document.querySelector(e.el):"object"==typeof e.el?m.elParent=e.el:m.elParent=e:m.elParent=document.body,e.mouse="boolean"!=typeof e.mouse||e.mouse,m.el=document.createElement("div"),m.el.id="uiSelector",m.el.className="ui-selector",m.el.setAttribute("hidden",!0),m.elParent.appendChild(m.el),m.hammer=new Hammer(m.elParent),m.hammer.get("pinch").set({enable:!0}),m.hammer.get("pan").set({threshold:5,direction:Hammer.DIRECTION_ALL}),m.hammer.on("panstart",t),m.elParent.addEventListener("mousemove",l),m.hammer.on("panend",s),m.hammer.on("tap",n),document.addEventListener("keydown",o),document.addEventListener("keyup",i),delete m.this.init,{on:m.this.on}},this.on=function(e,t){switch(e){case"selected":m.callback.selected.push(t);break;case"deselect":m.callback.deselect.push(t)}return{on:m.this.on}};var t=function(t){if(1!=m.mouseDown){if(m.mouseDown=!0,0==m.keys.shift&&0==m.keys.ctrl){m.pos.x.x=void 0===t.clientX?t.center.x:t.clientX,m.pos.x.y=void 0===t.clientY?t.center.y:t.clientY,m.this.calculPosition();var l=c(r(t.target));void 0!==e.draggable&&0!==l.length||m.el.removeAttribute("hidden")}m.this.getElements();var s=Array.prototype.slice.call(document.getElementsByClassName("ui-selected"));void 0!==e.draggable&&0!==s.length||m.this.eventClick(t);var n=document.getElementById("ui-dragmesh");return void 0!==e.draggable&&0!==s.length&&null===n&&m.this.dragObjects(s),!0}},l=function(e){if(0!=m.mouseDown){m.pos.y.x=e.clientX,m.pos.y.y=e.clientY,m.this.calculPosition();var t=document.getElementById("ui-dragmesh");return null===t?(m.el.removeAttribute("hidden"),m.this.detectElements()):m.el.setAttribute("hidden",!0),null!==t&&(t.style.top=m.pos.y.y+"px",t.style.left=m.pos.y.x+"px"),!0}},s=function(e){var t=document.getElementById("ui-dragmesh");return null!==t&&t.remove(),m.mouseDown=!1,m.el.setAttribute("hidden",!0),!0},n=function(e){return m.pos.x.x=e.clientX,m.pos.x.y=e.clientY,m.pos.y.x=e.clientX,m.pos.y.y=e.clientY,m.this.calculPosition(),m.this.getElements(),m.this.eventClick(e),!0},o=function(t){var l="object"==typeof e&&"object"==typeof e.keys;return m.keys.ctrl=(1!=l||!1!==e.keys.ctrl)&&t.ctrlKey,m.keys.shift=(1!=l||!1!==e.keys.shift)&&t.shiftKey,!0},i=function(e){return m.keys.ctrl=!1,m.keys.shift=!1,!0};this.dragObjects=function(e){var t=document.createElement("div");t.id="ui-dragmesh",t.style.position="absolute",t.style.top=m.pos.y.y+"px",t.style.left=m.pos.y.x+"px",t.style.opacity=.4,e.map(function(e){t.appendChild(e.cloneNode(!0))}),document.body.appendChild(t)},this.calculPosition=function(){return m.pos.left=Math.min(m.pos.x.x,m.pos.y.x),m.pos.top=Math.min(m.pos.x.y,m.pos.y.y),m.pos.right=Math.max(m.pos.x.x,m.pos.y.x),m.pos.bottom=Math.max(m.pos.x.y,m.pos.y.y),m.pos.width=m.pos.right-m.pos.left,m.pos.height=m.pos.bottom-m.pos.top,m.el.style.left=m.pos.left+"px",m.el.style.top=m.pos.top+"px",m.el.style.width=m.pos.right-m.pos.left+"px",m.el.style.height=m.pos.bottom-m.pos.top+"px",m.pos},this.getElements=function(){var e=Array.prototype.slice.call(document.getElementsByClassName("ui-element"));return e=e.concat(Array.prototype.slice.call(document.querySelectorAll("*[ui-element]"))),m.elements=e,m.elements},this.detectElements=function(e){if(!1===(e="boolean"!=typeof e||!0===e)&&(void 0==m.el.hidden||!0===m.el.hidden))return null;var t=[];for(var l in m.elements){var s=m.elements[l].getBoundingClientRect();1==u(s)?-1==m.elements[l].className.indexOf("ui-selected")&&(t.push(m.elements[l]),!0===e&&(m.elements[l].classList.add("ui-selected"),d("selected",m.elements[l]))):-1!=m.elements[l].className.indexOf("ui-selected")&&!0===e&&(m.elements[l].classList.remove("ui-selected"),d("deselect",m.elements[l]))}return t};var r=function(e){for(var t=[];e;){if(t.push(e),"HTML"===e.tagName)return t.push(document),t.push(window),t;e=e.parentElement}return t},c=function(e){return e.filter(function(e){return void 0!==e.className&&-1!==e.className.indexOf("ui-element")})};this.eventClick=function(t){for(var l=null,s=r(t.target),n=0;void 0!=s[n]&&(1!=n||"object"!=typeof e||!0!==e.onlyElement);n++)if(void 0!=s[n].className&&-1!==s[n].className.indexOf("ui-element")){l=s[n];break}if(0==m.keys.ctrl&&0==m.keys.shift)for(var o in m.elements)-1!=m.elements[o].className.indexOf("ui-selected")&&(m.elements[o].classList.remove("ui-selected"),d("deselect",m.elements[o]));null!=l&&(-1!=l.className.indexOf("ui-selected")?(l.classList.remove("ui-selected"),d("deselect",l)):(l.classList.add("ui-selected"),d("selected",l)),1==m.keys.shift&&a(l),m.lastTarget=l)};var a=function(e){for(var t=m.lastTarget;null!=(t=t.previousSibling)&&t!==e;);var l=null!=t;for(t=null==t?m.lastTarget:t;null!=(t=t.nextSibling)&&(void 0==t.style||(-1==t.className.indexOf("ui-selected")&&(t.classList.add("ui-selected"),d("selected",t)),t!==(1==l?m.lastTarget:e))););},u=function(e){return m.pos.top<=e.bottom&&m.pos.bottom>=e.top&&m.pos.left<=e.right&&m.pos.right>=e.left},d=function(e,t){for(var l in m.callback[e])"function"==typeof m.callback[e][l]&&m.callback[e][l](t)},m={this:this,hammer:null,elParent:null,el:null,elements:[],lastTarget:null,mouseDown:!1,keys:{ctrl:!1,shift:!1},pos:{width:0,height:0,left:0,top:0,right:0,bottom:0,x:{x:0,y:0},y:{y:0,x:0}},callback:{selected:[],deselect:[]}}}).init()};try{module.exports=uiSelector}catch(e){}