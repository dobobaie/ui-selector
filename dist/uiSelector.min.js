var uiSelector=function(e){return(new function(){this.init=function(){return"string"==typeof e?u.elParent=document.querySelector(e):"object"==typeof e&&void 0!=e.el?"string"==typeof e.el?u.elParent=document.querySelector(e.el):"object"==typeof e.el?u.elParent=e.el:u.elParent=e:u.elParent=document.body,e.mouse="boolean"!=typeof e.mouse||e.mouse,u.el=document.createElement("div"),u.el.id="uiSelector",u.el.className="ui-selector",u.el.setAttribute("hidden",!0),u.elParent.appendChild(u.el),1==e.mouse?(u.elParent.addEventListener("mousedown",t),u.elParent.addEventListener("mousemove",s),u.elParent.addEventListener("mouseup",l)):u.elParent.addEventListener("click",o),document.addEventListener("keydown",n),document.addEventListener("keyup",i),delete u.this.init,{on:u.this.on}},this.on=function(e,t){switch(e){case"selected":u.callback.selected.push(t);break;case"deselect":u.callback.deselect.push(t)}return{on:u.this.on}};var t=function(e){if(1!=u.mouseDown)return u.mouseDown=!0,0==u.keys.shift&&0==u.keys.ctrl&&(u.pos.x.x=e.clientX,u.pos.x.y=e.clientY,u.this.calculPosition(),u.el.removeAttribute("hidden")),u.this.getElements(),u.this.eventClick(e),!0},s=function(e){if(u.mouseMoveTry+=1,1!=u.mouseDown||1!=u.mouseMoveTry)return u.mouseMoveTry=0,u.pos.y.x=e.clientX,u.pos.y.y=e.clientY,u.this.calculPosition(),u.this.detectElements(),!0},l=function(e){return u.mouseDown=!1,u.el.setAttribute("hidden",!0),!0},o=function(e){return u.pos.x.x=e.clientX,u.pos.x.y=e.clientY,u.pos.y.x=e.clientX,u.pos.y.y=e.clientY,u.this.calculPosition(),u.this.getElements(),u.this.eventClick(e),!0},n=function(t){var s="object"==typeof e&&"object"==typeof e.keys;return u.keys.ctrl=(1!=s||!1!==e.keys.ctrl)&&t.ctrlKey,u.keys.shift=(1!=s||!1!==e.keys.shift)&&t.shiftKey,!0},i=function(e){return u.keys.ctrl=!1,u.keys.shift=!1,!0};this.calculPosition=function(){u.pos.left=Math.min(u.pos.x.x,u.pos.y.x),u.pos.top=Math.min(u.pos.x.y,u.pos.y.y),u.pos.right=Math.max(u.pos.x.x,u.pos.y.x),u.pos.bottom=Math.max(u.pos.x.y,u.pos.y.y),u.pos.width=u.pos.right-u.pos.left,u.pos.height=u.pos.bottom-u.pos.top,u.el.style.left=u.pos.left+"px",u.el.style.top=u.pos.top+"px",u.el.style.width=u.pos.right-u.pos.left+"px",u.el.style.height=u.pos.bottom-u.pos.top+"px"},this.getElements=function(){var e=Array.prototype.slice.call(document.getElementsByClassName("ui-element"));e=e.concat(Array.prototype.slice.call(document.querySelectorAll("*[ui-element]"))),u.elements=e},this.detectElements=function(){if(void 0!=u.el.hidden&&!0!==u.el.hidden)for(var e in u.elements){var t=u.elements[e].getBoundingClientRect();1==r(t)?-1==u.elements[e].className.indexOf("ui-selected")&&(u.elements[e].classList.add("ui-selected"),a("selected",u.elements[e])):-1!=u.elements[e].className.indexOf("ui-selected")&&(u.elements[e].classList.remove("ui-selected"),a("deselect",u.elements[e]))}},this.eventClick=function(t){for(var s=null,l=0;void 0!=t.path[l]&&(1!=l||"object"!=typeof e||!0!==e.onlyElement);l++)if(void 0!=t.path[l].className&&(-1!=t.path[l].className.indexOf("ui-element")||null!=t.path[l].getAttribute("ui-element"))){s=t.path[l];break}if(0==u.keys.ctrl&&0==u.keys.shift)for(var o in u.elements)-1!=u.elements[o].className.indexOf("ui-selected")&&(u.elements[o].classList.remove("ui-selected"),a("deselect",u.elements[o]));null!=s&&(-1!=s.className.indexOf("ui-selected")?(s.classList.remove("ui-selected"),a("deselect",s)):(s.classList.add("ui-selected"),a("selected",s)),1==u.keys.shift&&c(s),u.lastTarget=s)};var c=function(e){for(var t=u.lastTarget;null!=(t=t.previousSibling)&&t!==e;);var s=null!=t;for(t=null==t?u.lastTarget:t;null!=(t=t.nextSibling)&&(void 0==t.style||(-1==t.className.indexOf("ui-selected")&&(t.classList.add("ui-selected"),a("selected",t)),t!==(1==s?u.lastTarget:e))););},r=function(e){return u.pos.top<=e.bottom&&u.pos.bottom>=e.top&&u.pos.left<=e.right&&u.pos.right>=e.left},a=function(e,t){for(var s in u.callback[e])"function"==typeof u.callback[e][s]&&u.callback[e][s](t)},u={this:this,elParent:null,el:null,elements:[],lastTarget:null,mouseDown:!1,mouseMoveTry:0,keys:{ctrl:!1,shift:!1},pos:{width:0,height:0,left:0,top:0,right:0,bottom:0,x:{x:0,y:0},y:{y:0,x:0}},callback:{selected:[],deselect:[]}}}).init()};try{module.exports=uiSelector}catch(e){}