"function"==typeof require&&require("hammerjs");var uiSelector=function(e){return(new function(){this.init=function(){return f.elParent=t(e),e.mouse="boolean"!=typeof e.mouse||e.mouse,f.el=document.createElement("div"),f.el.id="uiSelector",f.el.className="ui-selector",f.el.setAttribute("hidden",!0),f.elParent.appendChild(f.el),f.hammer=new Hammer(f.elParent),f.hammer.get("pinch").set({enable:!0}),f.hammer.get("pan").set({threshold:5,direction:Hammer.DIRECTION_ALL}),f.hammer.on("panstart",n),f.elParent.addEventListener("mousemove",s),f.hammer.on("panend",r),f.hammer.on("tap",i),document.addEventListener("keydown",o),document.addEventListener("keyup",a),delete f.this.init,{on:f.this.on}};var t=function(e){return"string"==typeof e?document.querySelector(e):"object"==typeof e&&null!=e.el?"string"==typeof e.el?document.querySelector(e.el):"object"==typeof e.el?e.el:e:document.body},l=function(e){return"string"==typeof e?document.querySelectorAll(e):"object"==typeof e&&null!=e.el?"string"==typeof e.el?document.querySelectorAll(e.el):"object"==typeof e.el?Array.isArray(e.el)?e.el:[e.el]:Array.isArray(e)?e:[e]:[document.body]};this.on=function(e,t){switch(e){case"selected":f.callback.selected.push(t);break;case"deselect":f.callback.deselect.push(t);break;case"drag":f.callback.drag.push(t);break;case"dragcancelled":f.callback.dragcancelled.push(t);break;case"dragover":f.callback.dragover.push(t);break;case"drop":f.callback.drop.push(t)}return{on:f.this.on}};var n=function(t){if(1!=f.mouseDown){if(f.mouseDown=!0,0==f.keys.shift&&0==f.keys.ctrl){f.pos.x.x=void 0===t.clientX?t.center.x:t.clientX,f.pos.x.y=void 0===t.clientY?t.center.y:t.clientY,f.this.calculPosition();var l=d(c(t.target));void 0!==e.draggable&&0!==l.length||f.el.removeAttribute("hidden")}f.this.getElements();var n=Array.prototype.slice.call(document.getElementsByClassName("ui-selected"));void 0!==e.draggable&&0!==n.length||f.this.eventClick(t);var s=document.getElementById("ui-dragmesh");return void 0!==e.draggable&&0!==n.length&&null===s&&f.this.dragObjects(n),!0}},s=function(e){if(0!=f.mouseDown){f.pos.y.x=e.clientX,f.pos.y.y=e.clientY,f.this.calculPosition();var t=document.getElementById("ui-dragmesh");return null===t?(f.el.removeAttribute("hidden"),f.this.detectElements()):f.el.setAttribute("hidden",!0),null!==t&&(t.style.top=f.pos.y.y+"px",t.style.left=f.pos.y.x+"px",f.this.detectDragOver(e)),!0}},r=function(e){var t=document.getElementById("ui-dragmesh");null!==t&&(Array.prototype.slice.call(t.childNodes).map(function(e){var t=e.getAttribute("ui-id-draggable");e.remove();var l=f.elParent.querySelector('*[ui-id-draggable="'+t+'"]');l.removeAttribute("ui-id-draggable"),!1===f.drag.isOver&&p("dragcancelled",l)}),t.remove());var l=document.getElementById("ui-dragover");return null!==l&&(!0===f.drag.isOver&&Array.prototype.slice.call(document.querySelectorAll(".ui-selected")).map(function(e){l.parentNode.insertBefore(e,l),p("drop",e)}),l.remove()),f.mouseDown=!1,f.el.setAttribute("hidden",!0),!0},i=function(e){return f.pos.x.x=e.clientX,f.pos.x.y=e.clientY,f.pos.y.x=e.clientX,f.pos.y.y=e.clientY,f.this.calculPosition(),f.this.getElements(),f.this.eventClick(e),!0},o=function(t){var l="object"==typeof e&&"object"==typeof e.keys;return f.keys.ctrl=(1!=l||!1!==e.keys.ctrl)&&t.ctrlKey,f.keys.shift=(1!=l||!1!==e.keys.shift)&&t.shiftKey,!0},a=function(e){return f.keys.ctrl=!1,f.keys.shift=!1,!0};this.detectDragOver=function(t){var n=document.getElementById("ui-dragover");null!==n&&n.remove();var s=document.getElementById("ui-dragmesh");if(null!==s)if(0!==(!0===Array.isArray(e.draggable)?e.draggable:[e.draggable]).filter(function(e){return Array.prototype.slice.call(l(e)).filter(function(e){return e===t.target}).shift()}).length){var r=Array.prototype.slice.call(t.target.childNodes),i={left:t.clientX,top:t.clientY},o=null,a=null,c=null;if(r.map(function(e){if(void 0!==e.getBoundingClientRect&&-1!==e.className.indexOf("ui-element")&&-1===e.className.indexOf("ui-selected")){var l=e.getBoundingClientRect();if(null===o&&l.left<i.left&&l.top<=t.clientY&&l.bottom>=t.clientY)return o=e,void(i=l);l.left>i.left&&l.left<t.clientX&&l.top<=t.clientY&&l.bottom>=t.clientY&&(o=e,i=l),a=e,c=l}}),null===o&&null!==a&&c.bottom<t.clientY&&(o=a,i=c),null===o||null!==o.parentNode){f.drag.isOver=!0;var d=s.childNodes[0].cloneNode(!0);d.id="ui-dragover",d.classList.remove("ui-selected"),null===o?t.target.insertBefore(d,t.target.childNodes[0]):o.parentNode.insertBefore(d,o.nextSibling),p("dragover",d,s.childNodes.length)}else f.drag.isOver=!1}else f.drag.isOver=!1;else f.drag.isOver=!1};this.dragObjects=function(e){var t=document.createElement("div");t.id="ui-dragmesh",t.style.position="absolute",t.style.top=f.pos.y.y+"px",t.style.left=f.pos.y.x+"px",t.style.opacity=.4,e.map(function(e,l){var n=new Date;e.setAttribute("ui-id-draggable",n.getTime()+"-"+l);var s=e.cloneNode(!0);t.appendChild(s),p("drag",s)}),document.body.appendChild(t)},this.calculPosition=function(){return f.pos.left=Math.min(f.pos.x.x,f.pos.y.x),f.pos.top=Math.min(f.pos.x.y,f.pos.y.y),f.pos.right=Math.max(f.pos.x.x,f.pos.y.x),f.pos.bottom=Math.max(f.pos.x.y,f.pos.y.y),f.pos.width=f.pos.right-f.pos.left,f.pos.height=f.pos.bottom-f.pos.top,f.el.style.left=f.pos.left+"px",f.el.style.top=f.pos.top+"px",f.el.style.width=f.pos.right-f.pos.left+"px",f.el.style.height=f.pos.bottom-f.pos.top+"px",f.pos},this.getElements=function(){return f.elements=Array.prototype.slice.call(document.getElementsByClassName("ui-element")),f.elements},this.detectElements=function(e){if(!1==(e="boolean"!=typeof e||!0===e)&&(null==f.el.hidden||!0===f.el.hidden))return null;var t=[];for(var l in f.elements)if(-1!==f.elements[l].className.indexOf("ui-element")){var n=f.elements[l].getBoundingClientRect();1==m(n)?-1==f.elements[l].className.indexOf("ui-selected")&&(t.push(f.elements[l]),!0===e&&(f.elements[l].classList.add("ui-selected"),p("selected",f.elements[l]))):-1!=f.elements[l].className.indexOf("ui-selected")&&!0===e&&(f.elements[l].classList.remove("ui-selected"),p("deselect",f.elements[l]))}return t};var c=function(e){for(var t=[];e;){if(t.push(e),"HTML"===e.tagName)return t.push(document),t.push(window),t;e=e.parentElement}return t},d=function(e){return e.filter(function(e){return void 0!==e.className&&-1!==e.className.indexOf("ui-element")})};this.eventClick=function(t){for(var l=null,n=c(t.target),s=0;null!=n[s]&&(1!=s||"object"!=typeof e||!0!==e.onlyElement);s++)if(null!=n[s].className&&-1!==n[s].className.indexOf("ui-element")){l=n[s];break}if(0==f.keys.ctrl&&0==f.keys.shift)for(var r in f.elements)-1!=f.elements[r].className.indexOf("ui-selected")&&(f.elements[r].classList.remove("ui-selected"),p("deselect",f.elements[r]));null!=l&&-1!==l.className.indexOf("ui-element")&&(-1!=l.className.indexOf("ui-selected")?(l.classList.remove("ui-selected"),p("deselect",l)):(l.classList.add("ui-selected"),p("selected",l)),1==f.keys.shift&&u(l),f.lastTarget=l)};var u=function(e){for(var t=f.lastTarget;null!=(t=t.previousSibling)&&t!==e;);var l=null!=t;for(t=null==t?f.lastTarget:t;null!=(t=t.nextSibling)&&(void 0===t.style||-1===t.className.indexOf("ui-element")||(-1==t.className.indexOf("ui-selected")&&(t.classList.add("ui-selected"),p("selected",t)),t!==(1==l?f.lastTarget:e))););},m=function(e){return f.pos.top<=e.bottom&&f.pos.bottom>=e.top&&f.pos.left<=e.right&&f.pos.right>=e.left},p=function(e,t,l){for(var n in f.callback[e])"function"==typeof f.callback[e][n]&&f.callback[e][n](t,l)},f={this:this,hammer:null,elParent:null,el:null,elements:[],lastTarget:null,mouseDown:!1,drag:{isOver:!1},keys:{ctrl:!1,shift:!1},pos:{width:0,height:0,left:0,top:0,right:0,bottom:0,x:{x:0,y:0},y:{y:0,x:0}},callback:{selected:[],deselect:[],drag:[],dragcancelled:[],dragover:[],drop:[]}}}).init()};try{module.exports=uiSelector}catch(e){}