"function"==typeof require&&require("hammerjs");var uiSelector=function(e){return(new function(){this.init=function(){return y.elParent=t(e),e.mouse="boolean"!=typeof e.mouse||e.mouse,y.el=document.createElement("div"),y.el.id="uiSelector",y.el.className="ui-selector",y.el.setAttribute("hidden",!0),y.elParent.appendChild(y.el),y.hammer=new Hammer(y.elParent),y.hammer.get("pinch").set({enable:!0}),y.hammer.get("pan").set({threshold:5,direction:Hammer.DIRECTION_ALL}),y.hammer.on("panstart",n),y.elParent.addEventListener("mousemove",r),y.hammer.on("panend",s),y.hammer.on("tap",o),document.addEventListener("keydown",i),document.addEventListener("keyup",a),delete y.this.init,{on:y.this.on}};var t=function(e){return"string"==typeof e?document.querySelector(e):"object"==typeof e&&null!=e.el?"string"==typeof e.el?document.querySelector(e.el):"object"==typeof e.el?e.el:e:document.body},l=function(e){return"string"==typeof e?document.querySelectorAll(e):"object"==typeof e&&null!=e.el?"string"==typeof e.el?document.querySelectorAll(e.el):"object"==typeof e.el?Array.isArray(e.el)?e.el:[e.el]:Array.isArray(e)?e:[e]:[document.body]};this.on=function(e,t){switch(e){case"selected":y.callback.selected.push(t);break;case"deselect":y.callback.deselect.push(t);break;case"drag":y.callback.drag.push(t);break;case"dragcancelled":y.callback.dragcancelled.push(t);break;case"dragover":y.callback.dragover.push(t);break;case"drop":y.callback.drop.push(t)}return{on:y.this.on}};var n=function(t){if(1!=y.mouseDown){if(y.mouseDown=!0,0==y.keys.shift&&0==y.keys.ctrl){y.pos.x.x=void 0===t.clientX?t.center.x:t.clientX,y.pos.x.y=void 0===t.clientY?t.center.y:t.clientY,y.this.calculPosition();var l=d(c(t.target));void 0!==e.draggable&&0!==l.length||y.el.removeAttribute("hidden")}y.this.getElements();var n=Array.prototype.slice.call(document.getElementsByClassName("ui-selected"));void 0!==e.draggable&&0!==n.length||y.this.eventClick(t);var r=document.getElementById("ui-dragmesh");return void 0!==e.draggable&&0!==n.length&&null===r&&y.this.dragObjects(n),!0}},r=function(e){if(0!=y.mouseDown){y.pos.y.x=e.clientX,y.pos.y.y=e.clientY,y.this.calculPosition();var t=document.getElementById("ui-dragmesh");return null===t?(y.el.removeAttribute("hidden"),y.this.detectElements()):y.el.setAttribute("hidden",!0),null!==t&&(t.style.top=y.pos.y.y+"px",t.style.left=y.pos.y.x+"px",y.this.detectDragOver(e)),!0}},s=function(e){var t=document.getElementById("ui-dragmesh");null!==t&&(Array.prototype.slice.call(t.childNodes).map(function(e){var t=e.getAttribute("ui-id-draggable");e.remove();var l=y.elParent.querySelector('*[ui-id-draggable="'+t+'"]');l.removeAttribute("ui-id-draggable"),!1===y.drag.isOver&&p("dragcancelled",l)}),t.remove());var l=document.getElementById("ui-dragover");return null!==l&&(!0===y.drag.isOver&&Array.prototype.slice.call(document.querySelectorAll(".ui-selected")).map(function(e){l.parentNode.insertBefore(e,l),p("drop",e)}),l.remove()),y.mouseDown=!1,y.el.setAttribute("hidden",!0),!0},o=function(e){return y.pos.x.x=e.clientX,y.pos.x.y=e.clientY,y.pos.y.x=e.clientX,y.pos.y.y=e.clientY,y.this.calculPosition(),y.this.getElements(),y.this.eventClick(e),!0},i=function(t){var l="object"==typeof e&&"object"==typeof e.keys;return y.keys.ctrl=(1!=l||!1!==e.keys.ctrl)&&t.ctrlKey,y.keys.shift=(1!=l||!1!==e.keys.shift)&&t.shiftKey,!0},a=function(e){return y.keys.ctrl=!1,y.keys.shift=!1,!0};this.detectDragOver=function(t){var n=document.getElementById("ui-dragover");null!==n&&n.remove();var r=document.getElementById("ui-dragmesh");if(null!==r)if(0!==(!0===Array.isArray(e.draggable)?e.draggable:[e.draggable]).filter(function(e){return Array.prototype.slice.call(l(e)).filter(function(e){return e===t.target}).shift()}).length){var s=Array.prototype.slice.call(t.target.childNodes),o={left:t.clientX,top:t.clientY},i=null,a=null,c=null;if(s.map(function(e){if(void 0!==e.getBoundingClientRect&&-1!==e.className.indexOf("ui-element")&&-1===e.className.indexOf("ui-selected")){var l=e.getBoundingClientRect();if(null===i&&l.left<o.left&&l.top<=t.clientY&&l.bottom>=t.clientY)return i=e,void(o=l);l.left>o.left&&l.left<t.clientX&&l.top<=t.clientY&&l.bottom>=t.clientY&&(i=e,o=l),a=e,c=l}}),null===i&&null!==a&&c.bottom<t.clientY&&(i=a,o=c),null===i||null!==i.parentNode){y.drag.isOver=!0;var d=r.childNodes[0].cloneNode(!0);d.id="ui-dragover",d.classList.remove("ui-selected"),null===i?t.target.insertBefore(d,t.target.childNodes[0]):i.parentNode.insertBefore(d,i.nextSibling),p("dragover",d,r.childNodes.length)}else y.drag.isOver=!1}else y.drag.isOver=!1;else y.drag.isOver=!1};this.dragObjects=function(e){var t=document.createElement("div");t.id="ui-dragmesh",t.style.position="absolute",t.style.top=y.pos.y.y+"px",t.style.left=y.pos.y.x+"px",t.style.opacity=.4,e.map(function(e,l){var n=new Date;e.setAttribute("ui-id-draggable",n.getTime()+"-"+l);var r=e.cloneNode(!0);t.appendChild(r),p("drag",r)}),document.body.appendChild(t)},this.calculPosition=function(){return y.pos.left=Math.min(y.pos.x.x,y.pos.y.x),y.pos.top=Math.min(y.pos.x.y,y.pos.y.y),y.pos.right=Math.max(y.pos.x.x,y.pos.y.x),y.pos.bottom=Math.max(y.pos.x.y,y.pos.y.y),y.pos.width=y.pos.right-y.pos.left,y.pos.height=y.pos.bottom-y.pos.top,y.el.style.left=y.pos.left+"px",y.el.style.top=y.pos.top+"px",y.el.style.width=y.pos.right-y.pos.left+"px",y.el.style.height=y.pos.bottom-y.pos.top+"px",y.pos},this.getElements=function(){return y.elements=Array.prototype.slice.call(document.getElementsByClassName("ui-element")),y.elements},this.detectElements=function(e){if(!1==(e="boolean"!=typeof e||!0===e)&&(null==y.el.hidden||!0===y.el.hidden))return null;var t=[];for(var l in y.elements){var n=y.elements[l].getBoundingClientRect();1==m(n)?-1==y.elements[l].className.indexOf("ui-selected")&&(t.push(y.elements[l]),!0===e&&(y.elements[l].classList.add("ui-selected"),p("selected",y.elements[l]))):-1!=y.elements[l].className.indexOf("ui-selected")&&!0===e&&(y.elements[l].classList.remove("ui-selected"),p("deselect",y.elements[l]))}return t};var c=function(e){for(var t=[];e;){if(t.push(e),"HTML"===e.tagName)return t.push(document),t.push(window),t;e=e.parentElement}return t},d=function(e){return e.filter(function(e){return void 0!==e.className&&-1!==e.className.indexOf("ui-element")})};this.eventClick=function(t){for(var l=null,n=c(t.target),r=0;null!=n[r]&&(1!=r||"object"!=typeof e||!0!==e.onlyElement);r++)if(null!=n[r].className&&-1!==n[r].className.indexOf("ui-element")){l=n[r];break}if(0==y.keys.ctrl&&0==y.keys.shift)for(var s in y.elements)-1!=y.elements[s].className.indexOf("ui-selected")&&(y.elements[s].classList.remove("ui-selected"),p("deselect",y.elements[s]));null!=l&&(-1!=l.className.indexOf("ui-selected")?(l.classList.remove("ui-selected"),p("deselect",l)):(l.classList.add("ui-selected"),p("selected",l)),1==y.keys.shift&&u(l),y.lastTarget=l)};var u=function(e){for(var t=y.lastTarget;null!=(t=t.previousSibling)&&t!==e;);var l=null!=t;for(t=null==t?y.lastTarget:t;null!=(t=t.nextSibling)&&(null==t.style||(-1==t.className.indexOf("ui-selected")&&(t.classList.add("ui-selected"),p("selected",t)),t!==(1==l?y.lastTarget:e))););},m=function(e){return y.pos.top<=e.bottom&&y.pos.bottom>=e.top&&y.pos.left<=e.right&&y.pos.right>=e.left},p=function(e,t,l){for(var n in y.callback[e])"function"==typeof y.callback[e][n]&&y.callback[e][n](t,l)},y={this:this,hammer:null,elParent:null,el:null,elements:[],lastTarget:null,mouseDown:!1,drag:{isOver:!1},keys:{ctrl:!1,shift:!1},pos:{width:0,height:0,left:0,top:0,right:0,bottom:0,x:{x:0,y:0},y:{y:0,x:0}},callback:{selected:[],deselect:[],drag:[],dragcancelled:[],dragover:[],drop:[]}}}).init()};try{module.exports=uiSelector}catch(e){}